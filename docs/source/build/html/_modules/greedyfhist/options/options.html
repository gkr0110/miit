<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>greedyfhist.options.options &mdash; MIIT 11/02/2025 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster.custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster.bundle.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-shadow.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-punk.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-noir.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-light.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-borderless.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/micromodal.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/sphinx_rtd_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/js/hoverxref.js"></script>
        <script src="../../../_static/js/tooltipster.bundle.min.js"></script>
        <script src="../../../_static/js/micromodal.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> MIIT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">MIIT Python API</a></li>
</ul>


    


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MIIT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>greedyfhist.options.options</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for greedyfhist.options.options</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module contains all the options classes for configuring the registration.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.segmentation_options</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">SegmentationOptions</span><span class="p">,</span>
    <span class="n">YoloSegOptions</span><span class="p">,</span>
    <span class="n">TissueEntropySegOptions</span><span class="p">,</span>
    <span class="n">LuminosityAndAreaSegOptions</span>
<span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_3_step_pyramid_iterations</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a default 3 step pyramid with iterations 100, 50 and 10.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[int]: pyramid with iterations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_4_step_pyramid_iterations</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a default 4 step pyramid with iterations 100, 100, 50 and 10.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[int]:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_5_step_pyramid_iterations</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a default 5 step pyramid with iterations 100, 100, 50, 50 and 10.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[int]:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_load_default_resolution</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads the default resolution of 1024 x 1024.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[int, int]:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>

    
<span class="k">def</span><span class="w"> </span><span class="nf">_load_default_nr_resolution</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads the default resolution of 2048 x 2048 </span>
<span class="sd">    for nonrigid registration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[int, int]: </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">2048</span><span class="p">)</span>


<div class="viewcode-block" id="PreprocessingOptions"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.PreprocessingOptions">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PreprocessingOptions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contains all the options that can be used to register a moving to a fixed image.</span>
<span class="sd">        </span>
<span class="sd">    moving_sr: int = 30</span>
<span class="sd">        Color window radius for mean shift filtering in moving image.</span>

<span class="sd">    moving_sp: int = 25</span>
<span class="sd">        Pixel window readius for mean shift filtering in moving image.</span>
<span class="sd">        </span>
<span class="sd">    fixed_sr: int = 30</span>
<span class="sd">        Color window radius for mean shift filtering in fixed image.</span>
<span class="sd">        </span>
<span class="sd">    fixed_sp: int = 25</span>
<span class="sd">        Pixel window radius for mean shift filtering in fixed image.</span>

<span class="sd">    enable_denoising: bool = True</span>
<span class="sd">        Toggle for enabling denoising.</span>
<span class="sd">        </span>
<span class="sd">    disable_denoising_moving: bool = False</span>
<span class="sd">        Can be used to disable denoising in moving image.</span>
<span class="sd">        </span>
<span class="sd">    disable_denoising_fixed: bool = False</span>
<span class="sd">        Can be used to disable denoising in fixed image.       </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">moving_sr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">moving_sp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">fixed_sr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">fixed_sp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">enable_denoising</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">disable_denoising_moving</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">disable_denoising_fixed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    
    
    <span class="k">def</span><span class="w"> </span><span class="nf">__assign_if_present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assigns value of given key in args_dict if key in class&#39;s __annotations__.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (_type_):</span>
<span class="sd">            args_dict (_type_):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>
    
<div class="viewcode-block" id="PreprocessingOptions.parse_dict"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.PreprocessingOptions.parse_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function made to automatically parse attributes from dictionary. </span>

<span class="sd">        Args:</span>
<span class="sd">            args_dict (Dict): </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__assign_if_present</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">)</span>    </div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">PreprocessingOptions</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PreprocessingOptions</span><span class="p">()</span>

<div class="viewcode-block" id="PreprocessingOptions.default_options_nr"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.PreprocessingOptions.default_options_nr">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_options_nr</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">PreprocessingOptions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Default options for nonrigid registration.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PreprocessingOptions: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">PreprocessingOptions</span><span class="p">()</span>
        <span class="n">options</span><span class="o">.</span><span class="n">enable_denoising</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># options.disable_denoising_fixed = True</span>
        <span class="c1"># options.disable_denoising_moving = True</span>
        <span class="k">return</span> <span class="n">options</span></div></div>
    

<div class="viewcode-block" id="AffineGreedyOptions"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.AffineGreedyOptions">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AffineGreedyOptions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Commandline options parsed to Greedy. </span>

<span class="sd">    More detailed information can be found in Greedy&#39;s documentation.</span>
<span class="sd">    Some options are extended/overwritten.</span>

<span class="sd">    Attributes:</span>
<span class="sd">    </span>
<span class="sd">        dim: int </span>
<span class="sd">            Should always be set to 2.</span>

<span class="sd">        resolution: Tuple[int, int]</span>
<span class="sd">            Image resolution after downscaling for Greedy.  </span>

<span class="sd">        preprocessing_options: PreprocessingOptions</span>
<span class="sd">            Options for preprocessing.          </span>
<span class="sd">            </span>
<span class="sd">        kernel_size: int</span>
<span class="sd">            kernel size for &#39;ncc&#39; kernel metric.</span>
<span class="sd">            </span>
<span class="sd">        cost_function: str</span>
<span class="sd">            cost function used to optimize the registration. Should always be set to &#39;ncc&#39;.</span>
<span class="sd">            </span>
<span class="sd">        rigid_iterations: Union[int, str]</span>
<span class="sd">            Number of rigid iterations during initial registration of affine registration.</span>
<span class="sd">            If set to &#39;auto&#39;, the number of iterations for rigid matching</span>
<span class="sd">            is computed relative to the size of the offset from the </span>
<span class="sd">            center-of-mass initialization. Otherwise, uses the provided</span>
<span class="sd">            number. </span>
<span class="sd">            </span>
<span class="sd">        ia: str</span>
<span class="sd">            Initial image alignment. &#39;ia-com-init&#39; is a custom option for using the center-of-mass of image masks. Other options can be taken from Greedy. </span>
<span class="sd">            </span>
<span class="sd">        iteration_pyramid: List[int]</span>
<span class="sd">            Iterations in the multiresolution pyramid.</span>
<span class="sd">            </span>
<span class="sd">        n_threads: int</span>
<span class="sd">            Number of threads. Defaults to 1, but 8 has shown the fastest registrations.</span>
<span class="sd">            </span>
<span class="sd">        keep_affine_transform_unbounded: bool = True</span>
<span class="sd">            If true, keeps affine transform unbounded. Otherwise, affine</span>
<span class="sd">            transform is translated into a displacement field. Should be</span>
<span class="sd">            set to True.            </span>

<span class="sd">        dof: int = 12</span>
<span class="sd">            Degrees of freedom for registration. (6 = rigid, 12 = affine)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">_load_default_resolution</span><span class="p">)</span>
    <span class="n">preprocessing_options</span><span class="p">:</span> <span class="s1">&#39;PreprocessingOptions&#39;</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">PreprocessingOptions</span><span class="o">.</span><span class="n">default_options</span><span class="p">)</span>
    <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">cost_function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ncc&#39;</span>
    <span class="n">rigid_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">ia</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ia-com-init&#39;</span>
    <span class="n">iteration_pyramid</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">_get_4_step_pyramid_iterations</span><span class="p">)</span>
    <span class="n">n_threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">keep_affine_transform_unbounded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">dof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing_options</span> <span class="o">=</span> <span class="n">PreprocessingOptions</span><span class="p">()</span>

<div class="viewcode-block" id="AffineGreedyOptions.parse_dict"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.AffineGreedyOptions.parse_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function made to automatically parse attributes from dictionary. </span>

<span class="sd">        Args:</span>
<span class="sd">            args_dict (Dict): </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;preprocessing_options&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__assign_if_present</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;preprocessing_options&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing_options</span><span class="o">.</span><span class="n">parse_dict</span><span class="p">(</span><span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;preprocessing_options&#39;</span><span class="p">])</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">__assign_if_present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assigns value if key is present in class&#39;s __annotations__.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (Any):</span>
<span class="sd">            args_dict (Dict):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="AffineGreedyOptions.to_dict"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.AffineGreedyOptions.to_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options as dictionary.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">PreprocessingOptions</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">d</span></div>
            
<div class="viewcode-block" id="AffineGreedyOptions.default_options"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.AffineGreedyOptions.default_options">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s1">&#39;AffineGreedyOptions&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns default options.</span>

<span class="sd">        Returns:</span>
<span class="sd">            AffineGreedyOptions:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AffineGreedyOptions</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="NonrigidGreedyOptions"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.NonrigidGreedyOptions">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NonrigidGreedyOptions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Commandline options parsed to Greedy. </span>

<span class="sd">    More detailed information can be found in Greedy&#39;s documentation.</span>
<span class="sd">    Some options are extended/overwritten.</span>

<span class="sd">    Attributes:</span>
<span class="sd">    </span>
<span class="sd">        dim: int </span>
<span class="sd">            Should always be set to 2.</span>

<span class="sd">        resolution: Tuple[int, int]</span>
<span class="sd">            Image resolution after downscaling for Greedy.  </span>

<span class="sd">        preprocessing_options: PreprocessingOptions</span>
<span class="sd">            Options for preprocessing.          </span>
<span class="sd">            </span>
<span class="sd">        s1: float</span>
<span class="sd">            pre sigma value for nonrigid registration.</span>
<span class="sd">            </span>
<span class="sd">        s2: float</span>
<span class="sd">            post sigma value for nonrigid registration.</span>
<span class="sd">            </span>
<span class="sd">        kernel_size: int</span>
<span class="sd">            kernel size for &#39;ncc&#39; kernel metric.</span>
<span class="sd">            </span>
<span class="sd">        cost_function: str</span>
<span class="sd">            cost function used to optimize the registration. Should always be set to &#39;ncc&#39;.</span>
<span class="sd">            </span>
<span class="sd">        ia: str</span>
<span class="sd">            Initial image alignment. &#39;ia-com-init&#39; is a custom option for using the center-of-mass of image masks. Other options can be taken from Greedy. </span>
<span class="sd">            </span>
<span class="sd">        iteration_pyramid: List[int] </span>
<span class="sd">            Iterations in the multiresolution pyramid.</span>
<span class="sd">            </span>
<span class="sd">        n_threads: int</span>
<span class="sd">            Number of threads. Defaults to 1, but 8 has shown the fastest registrations.</span>
<span class="sd">            </span>
<span class="sd">        use_sv: bool</span>
<span class="sd">            Additional greedy option for nonrigid registration.</span>
<span class="sd">            </span>
<span class="sd">        use_svlb: bool</span>
<span class="sd">            Additional experimental greedy option for nonrigid registration.</span>
<span class="sd">            </span>
<span class="sd">        exp: Optional[int]</span>
<span class="sd">            Additional value used in conjunction with use_svlb.</span>
<span class="sd">            </span>
<span class="sd">        use_gm_trim: bool = True</span>
<span class="sd">            Passes the gm_trim param to greedy.</span>
<span class="sd">            </span>
<span class="sd">        tscale: str | None = None</span>
<span class="sd">            If not None, passes tscale to greedy.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">_load_default_nr_resolution</span><span class="p">)</span>
    <span class="n">preprocessing_options</span><span class="p">:</span> <span class="n">PreprocessingOptions</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">PreprocessingOptions</span><span class="o">.</span><span class="n">default_options_nr</span><span class="p">)</span>    
    <span class="n">s1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">s2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">cost_function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ncc&#39;</span>
    <span class="n">ia</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ia-com-init&#39;</span>
    <span class="n">iteration_pyramid</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">_get_4_step_pyramid_iterations</span><span class="p">)</span>
    <span class="n">n_threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">use_sv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">use_svlb</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">exp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">use_gm_trim</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">tscale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing_options</span><span class="o">.</span><span class="n">enable_denoising</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="NonrigidGreedyOptions.parse_dict"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.NonrigidGreedyOptions.parse_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function made to automatically parse attributes from dictionary. </span>

<span class="sd">        Args:</span>
<span class="sd">            args_dict (Dict): </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;preprocessing_options&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__assign_if_present</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;preprocessing_options&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing_options</span><span class="o">.</span><span class="n">parse_dict</span><span class="p">(</span><span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;preprocessing_options&#39;</span><span class="p">])</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">__assign_if_present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assigns value if key is present in class&#39;s __annotations__.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (Any):</span>
<span class="sd">            args_dict (Dict):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
<div class="viewcode-block" id="NonrigidGreedyOptions.to_dict"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.NonrigidGreedyOptions.to_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options as dictionary.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">PreprocessingOptions</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">d</span></div>
            
<div class="viewcode-block" id="NonrigidGreedyOptions.default_options"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.NonrigidGreedyOptions.default_options">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s1">&#39;NonrigidGreedyOptions&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns default options.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GreedyOptions:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">NonrigidGreedyOptions</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="NonrigidGreedyOptions.default_nrpt_options"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.NonrigidGreedyOptions.default_nrpt_options">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_nrpt_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s1">&#39;NonrigidGreedyOptions&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns suitable default options for nrpt registration.</span>

<span class="sd">        Returns:</span>
<span class="sd">            NonrigidGreedyOptions:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="n">NonrigidGreedyOptions</span><span class="p">()</span>
        <span class="n">opts</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">opts</span></div></div>


<div class="viewcode-block" id="TilingOptions"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.TilingOptions">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TilingOptions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Options for performing nonrigid tiling registration.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">    </span>
<span class="sd">        enable_tiling: bool = False</span>
<span class="sd">            Enables tiling. If False, standard non-rigid registration is used.</span>
<span class="sd">            </span>
<span class="sd">        tiling_mode: str = &#39;simple&#39;</span>
<span class="sd">            Tiling mode. Can either be &#39;simple&#39; or &#39;pyramid&#39;. </span>
<span class="sd">            </span>
<span class="sd">        stop_condition_tile_resolution: bool = False</span>
<span class="sd">            Relevant for pyramid tiling. One condition for stopping pyramid. If the size of </span>
<span class="sd">            a tile (without overlapping) if smaller than the downscaling resolution during </span>
<span class="sd">            registration, the pyramid is stopped. Ignored if `tiling_mode==&#39;simple&#39;`.</span>
<span class="sd">            </span>
<span class="sd">        stop_condition_pyramid_counter: bool = True</span>
<span class="sd">            Relevant for pyramid tiling. One condition for stopping pyramid. Stops as soon </span>
<span class="sd">            as the pyramid depth reaches `max_pyramid_depth`. Ignored if `tiling_mode==&#39;simple&#39;`.</span>
<span class="sd">            </span>
<span class="sd">        max_pyramid_depth: int | None = 0</span>
<span class="sd">            Relevant for pyramid tiling. Defines stop condition for `stop_condition_pyramid_counter`.</span>
<span class="sd">            </span>
<span class="sd">        pyramid_resolutions: list[int] | None = None</span>
<span class="sd">            Relevant for pyramid tiling. Defines the resolution of the tiles at each step of the pyramid.</span>
<span class="sd">        </span>
<span class="sd">        pyramid_tiles_per_axis: list[int] | None = None</span>
<span class="sd">            Relevant for pyramid tiling. Defines how many tiles are generated per axis. The number of tiles</span>
<span class="sd">            is then always the number of tiles on the x-axis * number of tiles on the y-axis.</span>
<span class="sd">        </span>
<span class="sd">        tile_overlap: list[float] | float = 0.75</span>
<span class="sd">            Relevant for pyramid tiling. Gives the overlap of two neighboring tiles.</span>
<span class="sd">            </span>
<span class="sd">        tiles_size: int | tuple[int, int] = 1024</span>
<span class="sd">            Relevant for simple tiling. Size of each tile extracted. </span>
<span class="sd">            </span>
<span class="sd">        min_overlap: float = 0.1</span>
<span class="sd">            Relevant for simple tiling. Minimum overlap between two neighboring tiles. Might be larger depending of how </span>
<span class="sd">            tiles fit into the images resolution. Last tile is likely to be affected if the tiles can not be evenly </span>
<span class="sd">            extracted from the image.</span>
<span class="sd">            </span>
<span class="sd">        n_procs: int | None = None</span>
<span class="sd">            Number of concurrent processes for tile registration. If None, tiles are registered sequentially.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">enable_tiling</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">tiling_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;simple&#39;</span>    
    <span class="n">stop_condition_tile_resolution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">stop_condition_pyramid_counter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">max_pyramid_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pyramid_resolutions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">pyramid_tiles_per_axis</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tile_overlap</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.75</span>
    <span class="n">tile_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">min_overlap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">n_procs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    
<div class="viewcode-block" id="TilingOptions.default_options"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.TilingOptions.default_options">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s1">&#39;TilingOptions&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns default options.</span>

<span class="sd">        Returns:</span>
<span class="sd">            TilingOptions: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TilingOptions</span><span class="p">()</span></div></div>
    

<div class="viewcode-block" id="RegistrationOptions"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.RegistrationOptions">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RegistrationOptions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contains all the options that can be used to register a moving to a fixed image.</span>
<span class="sd">    </span>
<span class="sd">    path_to_greedy: str | None = None</span>
<span class="sd">        Path to greedy executable. Only needed in the functional interface.</span>
<span class="sd">        In the object-oriented interface this property is set to </span>
<span class="sd">        `GreedyFHist.path_to_greedy` if necessary.</span>
<span class="sd">        </span>
<span class="sd">    segmentation: SegmentationOptions | Callable[[numpy.ndarray], numpy.ndarray] | str | None</span>
<span class="sd">        Handles segmentation accordingly:</span>
<span class="sd">        SegmentationOptions:</span>
<span class="sd">            Contains configuration for YOLO8 based segmentations.</span>
<span class="sd">        Callable:</span>
<span class="sd">            Excepts a segmentation function that takes an input image and returns a mask where</span>
<span class="sd">            1 denotes tissue area and 0 denotes background.</span>
<span class="sd">        str:</span>
<span class="sd">            One of &#39;yolo-seg&#39;, &#39;entropy-based-seg&#39;, &#39;lum-area-seg&#39;.</span>
<span class="sd">            If &#39;yolo-seg&#39;, the function `load_yolo_segmentation` is called to init a segmentation</span>
<span class="sd">            function based on the yolo model.</span>
<span class="sd">            </span>
<span class="sd">            If &#39;entropy-based-seg&#39;, the function `load_tissue_entropy_detection` is called with default</span>
<span class="sd">            parameters and `predict_tissue_from_entropy` function is loaded.</span>
<span class="sd">            </span>
<span class="sd">            If &#39;lum-area-seg&#39;, the function `load_tissue_luminosity_area_detection` is called with </span>
<span class="sd">            default values and `predict_tissue_from_luminosity_and_area` function is loaded.</span>
<span class="sd">        None:</span>
<span class="sd">            Loads yolo based segmentation with default options.</span>
<span class="sd">            </span>
<span class="sd">        Either an options object containing configuration parameters for the standard</span>
<span class="sd">        tissue segmentation or a segmentation function that takes an image an input</span>
<span class="sd">        and returns a mask.</span>
<span class="sd">        </span>
<span class="sd">    use_docker_container: bool = False</span>
<span class="sd">        If the greedy executable is called through a docker image, set this to True and </span>
<span class="sd">        set `path_to_greedy` to the name of the docker container with the greedy executable.</span>
<span class="sd">        </span>
<span class="sd">    affine_registration_options: AffineRegistrationOptions</span>
<span class="sd">        Options for preprocessing and calling Greedy with affine</span>
<span class="sd">        registration otions.</span>

<span class="sd">    nonrigid_registration_options: NonrigidRegistrationOptions</span>
<span class="sd">        Options for preprocessing and calling Greedy with nonrigid</span>
<span class="sd">        registration options.</span>

<span class="sd">    pre_sampling_factor: Union[float, str] = &#39;auto&#39;</span>
<span class="sd">        Sampling factor prior to preprocessing. Does not</span>
<span class="sd">        affect registration accuracy, but can help to speed up the  </span>
<span class="sd">        preprocessing considerable, especially for large images. If</span>
<span class="sd">        the factor is a float it is interpreted as a scaling factor</span>
<span class="sd">        that is applied on both images prior to preprocessing. If</span>
<span class="sd">        &#39;auto&#39;, then the `pre_sampling_max_img_size` is used to</span>
<span class="sd">        scale both images to have a maximum resolution of that factor.</span>
<span class="sd">        </span>
<span class="sd">    pre_sampling_max_img_size: Optional[int] = 2000</span>
<span class="sd">        Resizes moving and fixed image such that the largest axis</span>
<span class="sd">        of both images is set to a maximum of `pre_sampling_resize_factor`.</span>
<span class="sd">        This option is used if `pre_sampling_factor` is set to auto. </span>

<span class="sd">    do_affine_registration: bool = True</span>
<span class="sd">        Whether an affine registration is performed or not.</span>
<span class="sd">        </span>
<span class="sd">    do_nonrigid_registration: bool = True</span>
<span class="sd">        Whether a deformable registration is performed or not.     </span>

<span class="sd">    do_nrpt_registration: bool = False</span>
<span class="sd">        If True, will perform nonrigid-pyramidic tiling registration. Will </span>
<span class="sd">        automatically set `do_affine_registration` to False and use </span>
<span class="sd">        `nonrigid_registration_options` for registration of tiles.</span>

<span class="sd">    compute_reverse_nonrigid_registration: bool = False</span>
<span class="sd">        Compute the reverse nonrigid registration. If do_affine_registration</span>
<span class="sd">        is True, uses the inverse of affine transformation as an</span>
<span class="sd">        initialization, if affine registration is used. This options is typically</span>
<span class="sd">        used for groupwise registration if the reverse transform is needed as well.    </span>
<span class="sd">        </span>
<span class="sd">    keep_affine_transform_unbounded: bool = True</span>
<span class="sd">        If true, keeps affine transform unbounded. Otherwise, affine</span>
<span class="sd">        transform is translated into a displacement field. Should be</span>
<span class="sd">        set to True.</span>
<span class="sd">        </span>
<span class="sd">    temporary_directory: str = &#39;tmp&#39;</span>
<span class="sd">        Temporary directory used for storing Greedy in- and output.</span>
<span class="sd">        </span>
<span class="sd">    remove_temporary_directory: bool = True</span>
<span class="sd">        Sets whether the temporary directory is removed after</span>
<span class="sd">        registration.    </span>
<span class="sd">        </span>
<span class="sd">    disable_mask_generation: bool = False</span>
<span class="sd">        If True, does not generation masks. Internally, the whole image area is declared</span>
<span class="sd">        as a mask. Does nothing if masks are provided.</span>
<span class="sd">        </span>
<span class="sd">    tiling_options: TilingOptions</span>
<span class="sd">        Options for defining tiling options in nrpt registration.</span>
<span class="sd">        </span>
<span class="sd">    grp_n_proc: int | None = None</span>
<span class="sd">        Number of concurrent processes used during groupwise registration. If None, performs</span>
<span class="sd">        every registration sequentially.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">path_to_greedy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">segmentation</span><span class="p">:</span> <span class="n">SegmentationOptions</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">YoloSegOptions</span><span class="o">.</span><span class="n">default_options</span><span class="p">)</span>
    <span class="n">use_docker_container</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">affine_registration_options</span><span class="p">:</span> <span class="n">AffineGreedyOptions</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">AffineGreedyOptions</span><span class="o">.</span><span class="n">default_options</span><span class="p">)</span>
    <span class="n">nonrigid_registration_options</span><span class="p">:</span> <span class="n">NonrigidGreedyOptions</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">NonrigidGreedyOptions</span><span class="o">.</span><span class="n">default_options</span><span class="p">)</span>
    <span class="n">pre_sampling_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
    <span class="n">pre_sampling_max_img_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">2000</span>    
    <span class="n">do_affine_registration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">do_nonrigid_registration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">compute_reverse_nonrigid_registration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">temporary_directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;tmp&#39;</span>
    <span class="n">remove_temporary_directory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">disable_mask_generation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">tiling_options</span><span class="p">:</span> <span class="n">TilingOptions</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">TilingOptions</span><span class="o">.</span><span class="n">default_options</span><span class="p">)</span>
    <span class="n">grp_n_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">__assign_if_present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assigns value of given key in args_dict if key in class&#39;s __annotations__.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (_type_):</span>
<span class="sd">            args_dict (_type_):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">AffineGreedyOptions</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">NonrigidGreedyOptions</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">d</span>

<div class="viewcode-block" id="RegistrationOptions.parse_cmdln_dict"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.RegistrationOptions.parse_cmdln_dict">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse_cmdln_dict</span><span class="p">(</span><span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;RegistrationOptions&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets all values in dictionary that have a matching key in </span>
<span class="sd">        class&#39;s __annotation__ field. key/value pairs for GreedyOpts</span>
<span class="sd">        are put in a sub dict, called &#39;greedy&#39;. &#39;resolution&#39; is in</span>
<span class="sd">        string, e.g. &#39;1024x1024&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            args_dict (Dict): </span>

<span class="sd">        Returns:</span>
<span class="sd">            RegistrationOptions: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="n">RegistrationOptions</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;affine_registration_options&#39;</span><span class="p">,</span> <span class="s1">&#39;nonrigid_registration_options&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">opts</span><span class="o">.</span><span class="n">__assign_if_present</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">)</span>
        <span class="c1"># TODO: Remove that.</span>
        <span class="k">if</span> <span class="s1">&#39;affine_registration_options&#39;</span> <span class="ow">in</span>  <span class="n">args_dict</span><span class="p">:</span>
            <span class="n">opts</span><span class="o">.</span><span class="n">affine_registration_options</span><span class="o">.</span><span class="n">parse_dict</span><span class="p">(</span><span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;affine_registration_options&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;nonrigid_registration_options&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
            <span class="n">opts</span><span class="o">.</span><span class="n">nonrigid_registration_options</span><span class="o">.</span><span class="n">parse_dict</span><span class="p">(</span><span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;nonrigid_registration_options&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">opts</span></div>

<div class="viewcode-block" id="RegistrationOptions.default_options"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.RegistrationOptions.default_options">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RegistrationOptions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get default registration options.</span>

<span class="sd">        Returns:</span>
<span class="sd">            RegistrationOptions:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RegistrationOptions</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="RegistrationOptions.affine_only_options"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.RegistrationOptions.affine_only_options">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">affine_only_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RegistrationOptions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Default options for affine registration only.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            Registration Options:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="n">RegistrationOptions</span><span class="p">()</span>
        <span class="n">opts</span><span class="o">.</span><span class="n">nonrigid_registration_options</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">opts</span></div>
    
<div class="viewcode-block" id="RegistrationOptions.nonrigid_only_options"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.RegistrationOptions.nonrigid_only_options">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nonrigid_only_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RegistrationOptions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Default options for nonrigid registration only.</span>

<span class="sd">        Returns:</span>
<span class="sd">            RegistrationOptions: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="n">RegistrationOptions</span><span class="p">()</span>
        <span class="n">opts</span><span class="o">.</span><span class="n">do_affine_registration</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">opts</span><span class="o">.</span><span class="n">disable_mask_generation</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">opts</span></div>
    
<div class="viewcode-block" id="RegistrationOptions.nrpt_only_options"><a class="viewcode-back" href="../../../api.html#greedyfhist.options.options.RegistrationOptions.nrpt_only_options">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nrpt_only_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RegistrationOptions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Default options for nrpt registration only.</span>

<span class="sd">        Returns:</span>
<span class="sd">            RegistrationOptions: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="n">RegistrationOptions</span><span class="p">()</span>
        <span class="n">opts</span><span class="o">.</span><span class="n">do_affine_registration</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">opts</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Maximilian Wess.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>